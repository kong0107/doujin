<h2>自訂契約</h2>

<fieldset style="display: none; position: absolute; top: 0; right: 0; height: 100%; overflow: auto; background-color: #ccc; font-family: monospace; padding: .2em;">
    <legend style="position: absolute; text-align: right; top: 0; right: 0; padding: 0 .2em; border: none; cursor: pointer;" onclick="this.parentNode.parentNode.removeChild(this.parentNode);" title="Click to close.">Debug</legend>
    <div style="white-space: pre;">{{settings | json}}</div>
</fieldset>

<ul id="settings">
    <li *ngIf="settings.category.decided"><span (click)="unset('category')">{{settings.category.value}}</span></li>
    <li *ngIf="settings.contributor.decided"><span (click)="unset('contributor')">{{settings.contributor.value=="是"?"有":"無"}}商家出資</span></li>
    <li *ngIf="settings.workType.decided"><span (click)="unset('workType')">{{settings.workType.value}}</span></li>
</ul>

<section *ngIf="settings.category.display">
    <h3>契約類型</h3>
    <fieldset>
        <legend><h4>非出版性委託</h4></legend>
        <button class="btn" (click)="set('category', '設定圖')">設定圖</button>
        <button class="btn" (click)="set('category', '非出版單張')">單張圖</button>
    </fieldset>
    <fieldset>
        <legend><h4>出版性委託</h4></legend>
        <button class="btn" (click)="set('category', '出版插圖')">插圖</button>
        <button class="btn" (click)="set('category', '合本')">多人合本</button>
    </fieldset>
</section>

<section *ngIf="settings.contributor.display">
    <h3>是否有商家出資？</h3>
    <button class="btn" (click)="set('contributor', '是')">是</button>
    <button class="btn" (click)="set('contributor', '否')">否</button>
</section>

<section *ngIf="settings.delegation_data.display">
    <h3>委託資料及委託規格</h3>
    <section *ngIf="settings.workType.display">
        <h4>工作方式</h4>
        <section>
            <dl *ngIf="!settings.workType.decided || settings.workType.value == '先收全額'">
                <dt><button class="btn" [class.btn-success]="settings.workType.value == '先收全額'" (click)="set('workType', '先收全額')">簽約一開始就要收全額，繪師收到款項之後再動草稿</button></dt>
                <dd>契約自收到全部款項後生效</dd>
                <dd>本選項直接以「完稿」而非「完稿預覽檔案」進行驗收。</dd>
            </dl>
            <dl *ngIf="!settings.workType.decided || settings.workType.value == '尾款草稿'">
                <dt><button class="btn" [class.btn-success]="settings.workType.value == '尾款草稿'" (click)="set('workType', '尾款草稿')">簽約一開始就要收定金，繪師收到款項之後再動草稿；尾款待草稿確定後再收</button></dt>
                <dd>契約自收到定金後生效</dd>
                <dd>本選項直接以「完稿」而非「完稿預覽檔案」進行驗收。</dd>
            </dl>
            <dl *ngIf="!settings.workType.decided || settings.workType.value == '尾款定稿'">
                <dt><button class="btn" [class.btn-success]="settings.workType.value == '尾款定稿'" (click)="set('workType', '尾款定稿')">簽約一開始就要收定金，繪師收到款項之後再動草稿；尾款待完稿確定後再收</button></dt>
                <dd>契約自收到定金後生效</dd>
                <dd>本選項直接以「完稿預覽檔案」而非「完稿」進行驗收。</dd>
            </dl>
            <dl *ngIf="!settings.workType.decided || settings.workType.value == '完稿全額'">
                <dt><button class="btn" [class.btn-success]="settings.workType.value == '完稿全額'" (click)="set('workType', '完稿全額')">認完稿後一次收全額</button></dt>
                <dd>契約自收到定金後生效</dd>
                <dd>本選項直接以「完稿預覽檔案」而非「完稿」進行驗收。</dd>
            </dl>
            <button *ngIf="settings.workType.decided" class="btn btn-primary btn-xs" (click)="unset('workType')">選擇其他方式</button>
        </section>

        <section *ngIf="settings.workType.decided">
            <h5>請填寫下列項目</h5>

            <ul *ngIf="settings.workType.value=='先收全額'">
                <li>草稿於<input type="date" [(ngModel)]="settings.draftDeadline.value"><!--草稿繳交期限-->前繳交給委託主；定稿於<input type="date" [(ngModel)]="settings.finalDeadline.value"><!--定稿繳交期限-->前繳交給委託主。</li>
                <li>委託主應於簽約後<input type="number" [(ngModel)]="settings.fullPayPeriod.value" placeholder="付全額期間">日內付全額報酬共新台幣<input type="number" [(ngModel)]="settings.fullPayAmount.value" placeholder="全額報酬數額">元整給繪師（繪師收到報酬後契約才生效）；違約金數額約定為新台幣<input type="number" [(ngModel)]="settings.penaltyAmount.value" placeholder="違約金數額">元整。委託主沒有在期限內付清全額報酬，視同契約自始不成立。</li>
                <li>繪師交出草稿後，委託主應於<input type="number" [(ngModel)]="settings.draftFirstOpinionPeriod.value" placeholder="草稿初次意見期間">日內回應，委託主如果希望大修請於此時限前提出。逾期未回應者視同同意繪師目前的工作方向、放棄提出大修之要求。</li>
                <li>除了上一款的回應以外，委託主還可以在繪師交出草稿後<input type="number" [(ngModel)]="settings.draftFixRequestPeriod.value" placeholder="草稿開放小修期間">日內（請填寫比定稿繳交期限{{finalDeadline}}更早的時限），跟繪師提出<input type="number" [(ngModel)]="settings.draftFixNumber.value" placeholder="改稿次數">次的小修要求。繪師接到小修要求後應於<input type="number" [(ngModel)]="settings.draftFixRespondPeriod.value" placeholder="草稿小修回應期間">日內回應。</li>
                <li>繪師在定稿繳交期限{{finalDeadline}}前交出定稿後給委託主後，委託主應該在<input type="number" [(ngModel)]="settings.acceptPeriod.value" placeholder="驗收期間" min="1" pattern="\d+">日內通知繪師驗收結果。</li>
            </ul>
            <ul *ngIf="settings.workType.value=='尾款草稿'">
                <li>草稿於<input type="date" [(ngModel)]="settings.draftDeadline.value"><!--草稿繳交期限-->前繳交給委託主；定稿於<input type="date" [(ngModel)]="settings.finalDeadline.value"><!--定稿繳交期限-->前繳交給委託主。</li>
                <li>委託主應於簽約後<input type="number" [(ngModel)]="settings.earnestMoneyPeriod.value" placeholder="付定金期間">日內付定金共新台幣<input type="number" [(ngModel)]="settings.earnestMoneyAmount.value" placeholder="定金數額">元整給繪師（繪師收到定金後契約才生效）。委託主沒有在期限內付清全額定金，視同契約自始不成立。</li>
                <li>繪師第一次交出草稿後，委託主應於<input type="number" [(ngModel)]="settings.finalPayPeriod.value" placeholder="付尾款期間">日內付剩餘報酬共新台幣<input type="number" [(ngModel)]="settings.finalPayAmount.value" placeholder="尾款數額">元給繪師。委託主沒有在期限內付清尾款視同解約，並且無法收回定金。</li>
                <li>繪師交出草稿後，委託主應於<input type="number" [(ngModel)]="settings.draftFirstOpinionPeriod.value" placeholder="草稿初次意見期間">日內回應，委託主如果希望大修請於此時限前提出。逾期未回應者視同同意繪師目前的工作方向、放棄提出大修之要求。</li>
                <li>除了上一款的回應以外，委託主還可以在繪師交出草稿後<input type="number" [(ngModel)]="settings.draftFixRequestPeriod.value" placeholder="草稿開放小修期間">日內（請填寫比定稿繳交期限{{finalDeadline}}更早的時限），跟繪師提出<input type="number" [(ngModel)]="settings.draftFixNumber.value" placeholder="改稿次數">次的小修要求。繪師接到小修要求後應於<input type="number" [(ngModel)]="settings.draftFixRespondPeriod.value" placeholder="草稿小修回應期間">日內回應。</li>
                <li>繪師在定稿繳交期限{{finalDeadlinef}}前交出定稿後給委託主後，委託主應該在<input type="number" [(ngModel)]="settings.acceptPeriod.value" placeholder="驗收期間" min="1" pattern="\d+">日內通知繪師驗收結果。</li>
            </ul>
            <ul *ngIf="settings.workType.value=='尾款定稿'">
                <li>還沒改寫</li>
            </ul>
            <ul *ngIf="settings.workType.value=='完稿全額'">
                <li>還沒改寫</li>
            </ul>
        </section>
    </section>


    <section *ngIf="settings.workType.decided">
        <h4>雙方資料</h4>
        <section>
            <h5>甲方：繪師</h5>
            <dl>
                <dt>姓名</dt>
                <dd><input [(ngModel)]="settings.a_name.value"></dd>
                <dt>戶籍地址</dt>
                <dd><input [(ngModel)]="settings.a_permanentAddress.value"></dd>
                <dt>身分證號</dt>
                <dd><input [(ngModel)]="settings.a_id.value" pattern="[A-Z][12]\d{8}"></dd>
                <dt>電子郵件</dt>
                <dd><input [(ngModel)]="settings.a_email.value" type="email"></dd>
                <dt>通訊地址</dt>
                <dd><input [(ngModel)]="settings.a_correspondenceAddress.value"></dd>
                <dt>連絡電話</dt>
                <dd><input [(ngModel)]="settings.a_phone.value"></dd>
            </dl>
        </section>
        <section *ngIf="['出版插圖', '合本'].indexOf(category)> -1 && settings.contributor.value=='是'">
            <h5>乙方：委託商</h5>
            <dl>
                <dt>商家名稱</dt>
                <dd><input [(ngModel)]="settings.b_name.value"></dd>
                <dt>登記地址</dt>
                <dd><input [(ngModel)]="settings.b_permanentAddress.value"></dd>
                <dt>統一編號</dt>
                <dd><input [(ngModel)]="settings.b_id.value" pattern="\d{8}"></dd>
                <dt>代表人</dt>
                <dd><input [(ngModel)]="settings.b_chairperson.value"></dd>
                <dt>通訊地址</dt>
                <dd><input [(ngModel)]="settings.b_correspondenceAddress.value"></dd>
                <dt>聯絡電話</dt>
                <dd><input [(ngModel)]="settings.b_phone.value"></dd>
            </dl>
        </section>
        <section *ngIf="['出版插圖', '合本'].indexOf(category)==-1 || !settings.contributor.value">
            <h5>乙方：委託主</h5>
            <dl>
                <dt>姓名</dt>
                <dd><input [(ngModel)]="settings.b_name.value"></dd>
                <dt>戶籍地址</dt>
                <dd><input [(ngModel)]="settings.b_permanentAddress.value"></dd>
                <dt>身分證號</dt>
                <dd><input [(ngModel)]="settings.b_id.value" pattern="[A-Z][12]\d{8}"></dd>
                <dt>電子郵件</dt>
                <dd><input [(ngModel)]="settings.b_email.value" type="email"></dd>
                <dt>通訊地址</dt>
                <dd><input [(ngModel)]="settings.b_correspondenceAddress.value"></dd>
                <dt>連絡電話</dt>
                <dd><input [(ngModel)]="settings.b_phone.value"></dd>
            </dl>
        </section>
    </section>

    <section *ngIf="settings.workType.decided">
        <h4>匯款資料：繪師帳戶</h4>
        <dl>
            <dt>銀行名稱-代號</dt>
            <dd><input [(ngModel)]="settings.bank.value"></dd>
            <dt>戶名</dt>
            <dd><input [(ngModel)]="settings.accountName.value"></dd>
            <dt>帳號</dt>
            <dd><input [(ngModel)]="settings.accountNumber.value"></dd>
        </dl>
    </section>

    <section *ngIf="settings.workType.decided">
        <h4>委託內容</h4>
        <dl>
            <dt>委託名稱</dt>
            <dd><input [(ngModel)]="settings.delegation_name.value"></dd>
            <dt>委託內容</dt>
            <dd><textarea [(ngModel)]="settings.delegation_content.value" placeholder="對角色和畫面之描述"></textarea></dd>
            <dt>委託規格</dt>
            <dd><textarea [(ngModel)]="settings.delegation_format.value" placeholder="完稿的解析度、繳交檔案格式與其他規格；草稿檔案跟完稿預覽檔案的解析度、檔案格式與其他規格；交付以上檔案之方式（上傳網路硬碟讓委託主下載、郵寄隨身碟或光碟等）（本段預設為草稿與完稿為數位檔，紙本或其他實體請額外註明相關規格）"></textarea></dd>
            <dt>屬於「重大修改」的類型</dt>
            <dd><textarea [(ngModel)]="settings.seriousityDefinition.value" placeholder="改骨架，etc."></textarea></dd>
        </dl>
    </section>

    <button *ngIf="settings.workType.decided" class="btn" (click)="settings.delegation_data.display=false; settings.copyrightTerms.display=true">填好了，前往「選擇著作財產權條款」</button>
</section>

<section *ngIf="settings.copyrightTerms.display">
    <h3>選擇著作權條款</h3>
    <p>依照前面的委託型態，我們這邊預設一些著作權條款的組合。這邊一律設定繪師就是著作人。請確認是否符合雙方的需求，看狀況自行調整，並輸入必要欄位。</p>
    <section>
        <button class="btn" [class.btn-success]="settings.copyrightBelonging.value=='全部歸委託主'" (click)="set('copyrightBelonging', '全部歸委託主')">著作財產權歸委託主</button>
        <button class="btn" [class.btn-success]="settings.copyrightBelonging.value=='全部歸繪師'" (click)="set('copyrightBelonging', '全部歸繪師')">著作財產權歸繪師</button>
    </section>

    <section *ngIf="settings.copyrightBelonging.value=='全部歸委託主'">
        <dl>
            <dt>繪師在公開發表時使用的名稱</dt>
            <dd><input [(ngModel)]="settings.a_pseudonym.value"></dd>
            <dt>繪師可利用的範圍（單選）</dt>
            <dd>
                <select [(ngModel)]="settings.a_useRange.value">
                    <option value="全部可轉授權">永久、全部業務範圍內利用，得轉授權</option>
                    <option value="全部不可轉授權">永久、全部業務範圍內利用，不得轉授權</option>
                    <option>還沒好</option>
                </select>
            </dd>
        </dl>
        還沒好
    </section>
    <section *ngIf="settings.copyrightBelonging.value=='全部歸繪師'">
        <dl>
            <dt>委託主可利用的範圍</dt>
            <dd><select></select></dd>
        </dl>
        還沒好
    </section>
</section>

<hr>
<section *ngIf="false">
    <h3>契約內文（還沒好）</h3>

    <section *ngFor="let articleGroup of articleGroups">
        <h4>{{articleGroup.title}}</h4>
        <fieldset style="float: right;">
            <legend>顯示條件</legend>
            {{articleGroup.condition | json}}
        </fieldset>
        <article *ngFor="let article of articleGroup.articles">
            <h6><span></span><span>{{article.title}}</span></h6>
            <p>{{article.content}}</p>
        </article>
    </section>
</section>
